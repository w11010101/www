<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>upload</title>
    <link rel="stylesheet" type="text/css" href="/plugin/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/plugin/baguetteBox/css/baguetteBox.min.css">
    <link rel="stylesheet" type="text/css" href="/css/index.css">
</head>
<body onload="loaded()" class="">
   
    <div class="imgBox baguetteBox">
        <div id="wrapper" class="wrapper">
            <div id="scroller">
                <ul class="imgBoxList">
                    <!-- <li><img src="/imgs/1.jpg" alt=""><span></span></li>
                    <li><img src="/imgs/16.jpg" alt=""><span></span></li>
                    <li><img src="/imgs/17.jpg" alt=""><span></span></li>
                    <li><img src="/imgs/18.jpg" alt=""><span></span></li>
                    <li><img src="/imgs/19.jpg" alt=""><span></span></li>
                    <li><img src="/imgs/20.jpg" alt=""><span></span></li>
                    <li><img src="/imgs/11.jpg" alt=""><span></span></li>
                    <li><img src="/imgs/9.jpg" alt=""><span></span></li>
                    <li><img src="/imgs/12.jpg" alt=""><span></span></li>
                    <li><img src="/imgs/7.jpg" alt=""><span></span></li> -->
                </ul>
            </div>
        </div>
    </div>
    <form action="http://172.16.15.99:8081/upload_imgs" method="post" enctype="multipart/form-data">
        <!-- <input type="button" name="button" value="添加图片" class="addBtn"> -->
        <a class="addBtn">
            <input type="file" name="file" class="upload-file" multiple="true" />
        </a>
        <input type="submit" name="submit" value="开始上传" class="uploadBtn" /> 
    </form>
</body>
<script type="text/javascript" src="/plugin/jq/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="/plugin/jq/jquery.lazyload.js"></script>
<script type="text/javascript" src="/plugin/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/plugin/baguetteBox/js/baguetteBox.min.js"></script>
<script type="text/javascript" src="/plugin/iscroll/iscroll-probe.js"></script>
<script type="text/javascript" src="/js/common.js"></script>
<script type="text/javascript">
    // 监听 input file change 变化
    $(".upload-file").on("change",function (e){
        var file = this.value;

        for(var f of this.files){
            addImgs(getObjectURL(f));
        }
        // var imgArr = [];
        // $("img").each(function(i,e){
        //    imgArr.push(e.dataset.original);
        // })
        // console.log(imgArr)
        // $(".upload-file").attr("date-imgs",imgArr.join("|"));
        baguetteBox.run('.baguetteBox');
        runLazyload($(".imgBoxList"));
        setTimeout(function(args) {
            myScrollObj.wrapper.refresh();
        }, 100);

        
    })
    // 
    // $(".addBtn").on("click",function(){
    //     return $("input[type=file]").click();
    // })
    // 添加图片 
    function addImgs(file){
        var li = `<li>
                    <a href="${file}">
                        <img data-original="${file}" alt="">
                    </a>
                    <span></span>
                 </li>`;
        $(".imgBoxList").append(li); 
    }
    
    // 解析图片地址
    function getObjectURL(file) {
        var url = null;
        if (window.createObjcectURL != undefined) {
            url = window.createOjcectURL(file);
        } else if (window.URL != undefined) {
            url = window.URL.createObjectURL(file);
        } else if (window.webkitURL != undefined) {
            url = window.webkitURL.createObjectURL(file);
        }
        return url;
    }

    // $(".imgBox").on('change',function(){
    //     console.dir(this);
    // })
</script>
</html>